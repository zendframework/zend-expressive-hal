<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Hypertext Application Language for PSR-7 Applications">  
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>Representations - Hypertext Application Language</title>

    <link rel="stylesheet" href="../css/styles-e3f3751b65.css">
</head>
<body id="page-top">

    
    <div class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">

            
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            
            <span class="navbar-brand">
                <a class="logo-link" href="https://framework.zend.com/" data-tooltip data-placement="bottom" title="Go to the ZF homepage">
                    <img src="../img/zend-framework-logo.svg" height="28" alt="Zend Framework">
                </a>
            </span>
        </div>

        <div class="navbar-collapse collapse">

            
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://framework.zend.com/about">About</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/downloads">Install</a>
                </li>
                <li class="active">
                    <a href="https://docs.zendframework.com">Documentation</a>
                </li>
                <li>
                    <a href="https://www.zend.com/en/services/training">Training</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/blog">Blog</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/participate">Participate</a>
                </li>
            </ul>

            
            
                <div class="nav navbar-nav navbar-collapse visible-xs-block ">
                    <div class="subnavigation hidden-print">
    <h4 class="subnavigation__title">
        <a href="..">Hypertext Application Language</a>
    </h4>

    <h5 class="subnavigation__subtitle">Table of Contents</h5>

    <ul class="subnavigation__list">
        
            
                <li class="subnavigation__list-item ">
                    <a href=".." class="subnavigation__link">Hypertext Application Language (HAL) for PSR-7 Applications</a>
                </li>
            
        
            
                <li class="subnavigation__list-item ">
                    <a href="../intro/" class="subnavigation__link">Introduction</a>
                </li>
            
        
            
                <li class="subnavigation__list-item">
                    <span class="subnavigation__headline">Reference</span>
                    <ul class="subnavigation__list">
                        
                            
    <li class="subnavigation__list-item ">
        <a href="../hal/" class="subnavigation__link">HAL</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../links-and-resources/" class="subnavigation__link">Links and Resources</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../resource-generator/" class="subnavigation__link">Generating Resources</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../cookbook/generating-custom-resources/" class="subnavigation__link">Custom Resources</a>
    </li>

                        
                            
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Representations</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../factories/" class="subnavigation__link">Factories</a>
    </li>

                        
                    </ul>
                </li>
            
        
            
                <li class="subnavigation__list-item">
                    <span class="subnavigation__headline">Cookbook</span>
                    <ul class="subnavigation__list">
                        
                            
    <li class="subnavigation__list-item ">
        <a href="../cookbook/generating-custom-links-in-middleware/" class="subnavigation__link">Generating Custom Links In Middleware and Request Handlers</a>
    </li>

                        
                    </ul>
                </li>
            
        
    </ul>
</div>
                </div>
            

            
            <div class="nav navbar-nav navbar-collapse visible-xs-block">
                <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</div>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-xs-8">
                <h1 class="header__title">
                    Documentation

                    
                        <small class="header__subtitle">Hypertext Application Language</small>
                    
                </h1>
            </div>

            
            <div class="col-xs-4 text-right">
                
                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/zendframework/zend-expressive-hal/" class="header__link header__link--github" title="Go to repository of Hypertext Application Language">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-xs-12 content" role="main">
                
                    <ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
  <li><a href="https://framework.zend.com/">Home</a></li>
  <li><a href="https://docs.zendframework.com/">Docs</a></li>
  <li><a href="..">Hypertext Application Language</a></li>
  
    
      
        <li>Reference</li>
      
    
  
  <li class="active">Representations</li>
</ol>


    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">In This Article</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#renderers" class="toc__link">Renderers</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#halresponsefactory" class="toc__link">HalResponseFactory</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#using-the-factory" class="toc__link">Using the factory</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#forcing-collections-for-relations" class="toc__link">Forcing collections for relations</a>
                    </li>
                
            </ul>
        </div>
    


    <h1 id="generating-representations">Generating Representations</h1>
<p>This component provides two renderers, one each for creating JSON and XML
payloads.</p>
<p>Additionally, as noted in the <a href="../intro/">introduction</a> examples, this component
provides <code>Zend\Expressive\Hal\HalResponseFactory</code> for generating a
<a href="https://www.php-fig.org/psr/psr-7/">PSR-7</a> response containing the HAL
representation. This chapter dives into that with more detail.</p>
<h2 id="renderers">Renderers</h2>
<p>All renderers implement <code>Zend\Expressive\Hal\Renderer\RendererInterface</code>:</p>
<pre class="codehilite"><code class="language-php">namespace Zend\Expressive\Hal\Renderer;

use Zend\Expressive\Hal\HalResource;

interface RendererInterface
{
    public function render(HalResource $resource) : string;
}</code></pre>

<p>Two implementations are provided, <code>Zend\Expressive\Hal\Renderer\JsonRenderer</code> and
<code>Zend\Expressive\Hal\Renderer\XmlRenderer</code></p>
<h3 id="jsonrenderer">JsonRenderer</h3>
<p>The <code>JsonRenderer</code> constructor allows you to specify a bitmask of flags for use
with <code>json_encode()</code>. By default, if none are provided, it uses the value of
<code>JsonRenderer::DEFAULT_JSON_FLAGS</code>, which evaluates to:</p>
<pre class="codehilite"><code class="language-php">JSON_UNESCAPED_SLASHES
| JSON_UNESCAPED_UNICODE
| JSON_PRESERVE_ZERO_FRACTION</code></pre>

<p>When your application is in "debug" mode, it also adds the <code>JSON_PRETTY_PRINT</code>
flag to the default list, in order to provide human-readable JSON output.</p>
<h3 id="xmlrenderer">XmlRenderer</h3>
<p>The <code>XmlRenderer</code> produces XML representations of HAL resources. It has no
constructor arguments at this time.</p>
<h2 id="halresponsefactory">HalResponseFactory</h2>
<p><code>HalResponseFactory</code> generates a PSR-7 response containing a representation of
the provided <code>HalResource</code> instance. In order to keep the component agnostic of
PSR-7 implementation, <code>HalResponseFactory</code> itself composes a callable factory
capable of producing an empty PSR-7 response.</p>
<p>As an example:</p>
<pre class="codehilite"><code class="language-php">use Slim\Http\Response;
use Slim\Http\Stream;
use Zend\Expressive\Hal\HalResponseFactory;

$factory = new HalResponseFactory(
    function () {
        return new Response();
    }
);</code></pre>

<p>Additionally, the <code>HalResponseFactory</code> constructor can accept the following
arguments, with the described defaults if none is provided:</p>
<ul>
<li>A <code>JsonRenderer</code> instance is created if none is provided.</li>
<li>An <code>XmlRenderer</code> instance is created if none is provided.</li>
</ul>
<p>We provide a <a href="https://www.php-fig.org/psr/psr-11">PSR-11</a> compatible factory for
generating the <code>HalResponseFactory</code>, described in <a href="../factories/#zendexpressivehalhalresponsefactoryfactory">the factories
chapter</a>.</p>
<h2 id="using-the-factory">Using the factory</h2>
<p>The factory exposes one method:</p>
<pre class="codehilite"><code class="language-php">use Psr\Http\Message\ResponseInterface;
use Psr\Http\Message\ServerRequestInterface;
use Zend\Expressive\Hal\HalResource;

public function createResponse(
    ServerRequestInterface $request,
    HalResource $resource,
    string $mediaType = self::DEFAULT_CONTENT_TYPE
) : ResponseInterface {</code></pre>

<p>Generally speaking, you'll pass the current request instance, and the resource
for which you want to generate a response, and the factory will return a
response based on its response prototype, with the following:</p>
<ul>
<li>A <code>Content-Type</code> header with the base media type of <code>application/hal</code>.</li>
<li>A message body containing the representation.</li>
</ul>
<p>The request instance is used to determine what representation to create, based
on the <code>Accept</code> header. If it matches a JSON media type, a JSON representation
is created, and the <code>Content-Type</code> will be appended with <code>+json</code>; for XML, an
XML representation is created, and the <code>Content-Type</code> will be appended with
<code>+xml</code>. If no media type is matched, XML is generated.</p>
<p>One practice often used is to provide a <em>custom media type</em> for your
representations. While they will still be HAL, this allows you to document the
specific structure of your resources, and potentially even validate them against
JSON schema.</p>
<p>To do this, pass the media type when creating the response:</p>
<pre class="codehilite"><code class="language-php">$response = $factory-&gt;createResponse(
    $request,
    $resource,
    'application/vnd.book'
);</code></pre>

<p><em>Do not</em> pass the format (e.g., <code>+json</code>, <code>+xml</code>) when doing so; the factory will
append the appropriate one based on content negotiation.</p>
<h2 id="forcing-collections-for-relations">Forcing collections for relations</h2>
<p>HAL allows links and embedded resources to be represented as:</p>
<ul>
<li>a single object</li>
<li>an array of objects of the same type</li>
</ul>
<p>Internally, this package checks to see if only one of the item exists, and, if
so, it will render it by itself. However, there are times you may want to force
an array representation. As an example, if your resource models a car, and you
have a <code>wheels</code> relation, it would not make sense to return a single wheel, even
if that's all the car currently has associated with it.</p>
<p>To accommodate this, we provide two features.</p>
<p>For links, you may pass a special attribute, <code>Zend\Expressive\Hal\Link::AS_COLLECTION</code>,
with a boolean value of <code>true</code>; when encountered, this will then be rendered as
an array of links, even if only one link for that relation is present.</p>
<pre class="codehilite"><code class="language-php">$link = new Link(
    'wheels',
    '/api/car/XXXX-YYYY-ZZZZ/wheels/111',
    false,
    [Link::AS_COLLECTION =&gt; true]
);

$resource = $resource-&gt;withLink($link);</code></pre>

<p>In the above, you will then get the following within your representation:</p>
<pre class="codehilite"><code class="language-json">&quot;_links&quot;: {
  &quot;wheels&quot;: [
    {&quot;href&quot;: &quot;/api/car/XXXX-YYYY-ZZZZ/wheels/111&quot;}
  ]
}</code></pre>

<p>To force an embedded resource to be rendered within an array, you have two
options.</p>
<p>First, and simplest, pass the resource within an array when calling
<code>withElement()</code>, <code>embed()</code>, or passing data to the constructor:</p>
<pre class="codehilite"><code class="language-php">// Constructor:
$resource = new HalResource(['wheels' =&gt; [$wheel]]);

// withElement():
$resource = $resource-&gt;withElement('wheels', [$wheel]);

// embed():
$resource = $resource-&gt;embed('wheels', [$wheel]);</code></pre>

<p>Alternately, you can call the <code>HalResource::embed</code> method with only the
resource, passing the method a third argument, a flag indicating whether or not
to force an array:</p>
<pre class="codehilite"><code class="language-php">$resource = $resource-&gt;embed('wheels', $wheel, true);</code></pre>

<p>In each of these cases, assuming no other wheels were provided to the final
resource, you might get a representation such as the following:</p>
<pre class="codehilite"><code class="language-json">&quot;_embedded&quot;: {
  &quot;wheels&quot;: [
    {
      &quot;_links&quot; =&gt; {&quot;self&quot;: {&quot;href&quot;: &quot;...&quot;}}
      &quot;id&quot;: &quot;...&quot;
    },
  ]
}</code></pre>



    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../cookbook/generating-custom-resources/">
                    <i class="fa fa-chevron-left"></i> Previous
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../factories/">
                    Next <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>


<div class="help-wanted">
    <p>
        Found a mistake or want to contribute to the documentation?
        <a href="https://github.com/zendframework/zend-expressive-hal/edit/master/docs/representations.md" target="_blank" class="help-wanted__link">
            Edit this page on GitHub!
        </a>
    </p>
</div>
                
            </div>
            <div class="col-md-3 col-xs-12 sidebar">
                
                    <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    <div class="subnavigation hidden-print">
    <h4 class="subnavigation__title">
        <a href="..">Hypertext Application Language</a>
    </h4>

    <h5 class="subnavigation__subtitle">Table of Contents</h5>

    <ul class="subnavigation__list">
        
            
                <li class="subnavigation__list-item ">
                    <a href=".." class="subnavigation__link">Hypertext Application Language (HAL) for PSR-7 Applications</a>
                </li>
            
        
            
                <li class="subnavigation__list-item ">
                    <a href="../intro/" class="subnavigation__link">Introduction</a>
                </li>
            
        
            
                <li class="subnavigation__list-item">
                    <span class="subnavigation__headline">Reference</span>
                    <ul class="subnavigation__list">
                        
                            
    <li class="subnavigation__list-item ">
        <a href="../hal/" class="subnavigation__link">HAL</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../links-and-resources/" class="subnavigation__link">Links and Resources</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../resource-generator/" class="subnavigation__link">Generating Resources</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../cookbook/generating-custom-resources/" class="subnavigation__link">Custom Resources</a>
    </li>

                        
                            
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Representations</a>
    </li>

                        
                            
    <li class="subnavigation__list-item ">
        <a href="../factories/" class="subnavigation__link">Factories</a>
    </li>

                        
                    </ul>
                </li>
            
        
            
                <li class="subnavigation__list-item">
                    <span class="subnavigation__headline">Cookbook</span>
                    <ul class="subnavigation__list">
                        
                            
    <li class="subnavigation__list-item ">
        <a href="../cookbook/generating-custom-links-in-middleware/" class="subnavigation__link">Generating Custom Links In Middleware and Request Handlers</a>
    </li>

                        
                    </ul>
                </li>
            
        
    </ul>
</div>
                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <h5>Zend Framework</h5>
                <ul>
                    <li><a href="https://framework.zend.com/">framework.zend.com</a></li>
                    <li><a href="https://docs.zendframework.com">docs.zendframework.com</a></li>
                    <li><a href="https://packages.zendframework.com">packages.zendframework.com</a></li>
                    <li><a href="https://apigility.org">apigility.org</a></li>
                    <li><a href="https://getexpressive.org/">getexpressive.org</a></li>
                </ul>
            </div>
        </div>

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">

            
            <div class="col-md-9">
                <h4 class="footer__headline">Copyright</h4>
                <p>&copy; 2006-2018 by <a href="https://www.zend.com/">Zend</a>, a <a href="https://www.roguewave.com/">Rogue Wave Company</a>.</p>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">Support</h4>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://discourse.zendframework.com" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://zendframework-slack.herokuapp.com" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://github.com/zendframework" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/zfdevteam" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>

    <script>
        var base_url = '..',
            siteName = 'Hypertext Application Language';
    </script>
    <script src="../js/scripts-dcbafde59f.js"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>



</body>


</html>
